<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/intro.css">
    <script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
    <script src="js/jquery.js"></script>
</head>

<body>
    <div id="app">
        <img class="bg" src="img/bg2.jpg">
        <div class="box under">
            <img class="npc" src="img/npc.png">
        </div>
        <div class="box front" onclick="change()">
            <p id="w1"></p>
            <p id="w2"></p>
            <p id="w3"></p>
            <img class="arrow2" src="img/arrow2.png">
        </div>
    </div>
    <script src="js/conf.js"></script>
    <script>
        var tt = 0;
        window.onload = function () {
            $("#w1").html("奔波至此，你对前路的方向如何选择？在这");
            $("#w2").html("份flag清单里面立下属于自己的flag，来预");
            $("#w3").html("告你的大学时光吧！");
            $("#w1").addClass("word ty");
            $("#w2").addClass("word ty ty2");
            $("#w3").addClass("word ty ty3");
            clock = setInterval("count()", 1000);
        }

        function count() {
            tt++;
            console.log(tt);
        }
        var status = 0;
        var flaged = false

        function change() {
            if ((status == 0) && (tt >= 5)) {
                clearInterval(clock);
                tt = 0;
                clock = setInterval("count()", 1000);
                $("#w1").removeClass("word ty");
                $("#w2").removeClass("word ty ty2");
                $("#w1").html("待到毕业之时回顾，看看有多少flag能被打");
                $("#w2").html("破~");
                $("#w3").html("");
                setTimeout(function () {
                    $("#w1").addClass("word ty");
                    $("#w2").addClass("word ty ty2");
                }, 1);
                status = 1;
            }
            // judge weather 立 flag already
            $.ajax({
                url: prefix + "checkFlag",
                type: "get",
                success: function (res) {
                    if (res.check_flag)
                        flaged = true
                }
            })
            if ((status == 1) && (tt >= 3)) {
                clearInterval(clock);
                tt = 0;
                if (!flaged)
                    window.location.href = "flag.html";
                else
                    window.location.href = "flaglist.html"
            }
        }
    </script>
</body>

</html>